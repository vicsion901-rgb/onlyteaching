# 학생명부: 생년월일 표시/저장(고정 문구 문제) 수정

- 날짜/시간: 2026-01-24 20:21:46
- 작업 폴더: `/Users/dev/onlyT_test1`

## 사용자 프롬프트

목표: 학생명부 화면에서 '생년월일(사용 안함)'이 아니라 실제 생년월일이 표시/저장되도록 수정한다.

현재 상황:
- 엑셀 업로드 후 학생 목록에는 name / address는 표시되지만 birth_date는 "생년월일(사용 안함)"으로 고정 문구가 뜬다.
- 백엔드 Excel import API는 { student_number, name, birth_date, resident_id, address } 형태로 통일 JSON을 반환하고 DB에도 저장한다.
- 프론트는 Student 목록 테이블에서 birth_date 필드를 렌더링하지 않거나, API 응답의 birth_date를 state에 반영하지 않고 있다.

요구사항:
1) 프론트에서 학생 리스트 렌더링 시 birth_date가 있으면 그 값을 표시한다.
2) birth_date가 없고 resident_id가 있으면 resident_id 앞 6자리에서 YYMMDD를 추출해 birth_date로 표시한다.
3) birth_date가 완전히 없으면만 "생년월일(사용 안함)" 문구를 표시한다.
4) 엑셀 업로드 응답으로 내려오는 students 배열(data) 또는 DB에서 조회한 학생 리스트에서 birth_date 필드를 프론트 모델/상태에 포함시키고, 렌더링에서 사용하도록 수정한다.
5) 백엔드 저장 로직도 점검: resident_id가 있으면 birth_date가 주민번호 앞 6자리로 자동 생성되어 저장되도록 보장한다.
6) 수정해야 할 파일은 실제 프로젝트 구조를 검색해서 찾아서 패치해라:
   - frontend/src/pages/StudentRecords.jsx 또는 학생명부 화면 컴포넌트
   - frontend/src/api/... 학생 리스트/업로드 호출부
   - backend-node/src/students/entities/student.entity.ts (birthDate 컬럼 존재 확인)
   - backend-node/src/students/student.repository.ts (birthDate 저장 확인)
   - backend-node/src/excel/... (birth_date 생성/추출 확인)
7) 결과: 업로드 후 목록에 생년월일이 실제로 표시되며, 새로고침 후에도 DB에서 가져온 값이 유지된다.

출력:
- 변경된 파일 목록
- 각 파일의 변경 전후 핵심 코드(diff 형태 또는 전체 코드)
- birth_date 표시 포맷: "YYYY-MM-DD" 또는 "YYMMDD" 중 하나로 통일하고, 화면에서는 YYYY-MM-DD로 보여주도록 변환 함수를 추가해라.

## AI 답변

- 프론트
  - 기존에 `birthDateColumn`이 null이면 무조건 "생년월일(사용 안함)"을 렌더링하던 로직을 수정해,
    `birthDate/birth_date` → `residentNumber/resident_id` → (둘 다 없을 때만) "생년월일(사용 안함)" 순으로 표시.
  - **중요 버그 수정**: `/student-records/bulk` 저장 payload에서 `birthDate`가 누락되어 업로드로 저장된 birthDate가 null로 덮이는 문제를 방지하기 위해 payload에 `birthDate`를 포함.

- 백엔드
  - `backend-node/src/excel/excel.mapper.ts`에서 주민번호 기반 birth_date를 기존 YYMMDD(6자리)로 저장하던 것을,
    `YYYY-MM-DD`로 정규화하여 저장하도록 개선(세기 판별 포함).
