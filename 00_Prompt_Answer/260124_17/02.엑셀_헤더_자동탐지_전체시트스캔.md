# 엑셀 헤더 자동 탐지(전체 시트 스캔)

- 날짜/시간: 2026-01-24 17:52:56
- 작업 폴더: `/Users/dev/onlyT_test1`

## 사용자 프롬프트

엑셀 파일에서 첫 번째 행이 아니라 전체 시트를 스캔해서
헤더 후보 행을 자동 탐지하도록 수정해줘.

조건:
- "이름", "성명", "학생명", "주민번호", "생년월일", "주소", "학번", "번호" 같은 키워드 포함된 행을 헤더로 판단
- 없으면 첫 행을 강제로 헤더로 설정
- pandas read_excel(header=None)으로 불러온 후 헤더 row index 자동 탐색

Node.js + xlsx 환경에서 구현 코드 전체 수정해서 보여줘.

## AI 답변

- `xlsx`에서 `sheet_to_json({ header: 1 })`로 **헤더 없이 2차원 배열(matrix)**을 만든 뒤(= pandas의 `header=None`과 동일한 접근),
  시트 전체를 스캔하여 **키워드 포함 행을 헤더로 자동 탐지**하도록 백엔드 코드를 수정했습니다.
- 키워드 매칭 후보가 **없으면 0행을 강제로 헤더**로 설정되며, 이 강제 규칙이 후속 보정 로직에 의해 깨지지 않도록 서비스 로직도 함께 보완했습니다.
- 적용 위치:
  - `backend-node/src/excel/utils/detectHeaderRow.ts` (전체 시트 스캔 + 강제 0행 규칙)
  - `backend-node/src/excel/excel.service.ts` (강제 0행 유지)
  - `backend-node/src/student-records/excel-upload.util.ts` (동일 탐지 로직 적용)
