# 학생명부 엑셀 업로드: 이름/주소 자동매핑 복구

- 일시: 2026-01-25 17:01:13

## 사용자 프롬프트
원래 액셀파일 반영하면 이름, 주소는 입력이 되엇엇는데 로직이 다 깨졋어

## AI 답변
- 원인: /student-records/upload-excel 파서가 "0번째 행을 헤더"로 고정해서, 상단에 제목/안내 줄이 있는 엑셀에서 컬럼 매핑이 실패하며 이름/주소가 비는 문제가 발생할 수 있음.
- 조치: backend-node/src/student-records/excel-upload.util.ts에서 헤더 행을 상단 30행 스캔으로 자동 탐지하도록 수정(제목성 단일셀 행 제외).
- 반영: 백엔드 3000 포트를 사용하는 프로세스를 정리한 뒤 Nest를 재기동하여 변경분 적용.
- 확인: /health, /api 응답 200 확인.

## 사용자 확인 방법
- 학생명부 > 엑셀 업로드 후, 응답의 mapping.__meta.headerRowIndex가 실제 헤더 행을 가리키는지 확인(내부 디버그 메타).
